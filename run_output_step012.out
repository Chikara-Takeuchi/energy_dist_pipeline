[Step0] preprocessing annotation files
Folder already exist /project/GCRB/Hon_lab/s223695/Data_project/Perturb_seq_edist_pipeline/pipeline_output
(array(['neg_control', 'non-targeting', 'pos_control', 'target'],
      dtype=object), array([  598,   600,    18, 13142]))
[Step1] Filtering outlier gRNAs
--- Processing PCA data ---
Loading existing PCA file '/project/GCRB/Hon_lab/s223695/Data_project/Perturb_seq_edist_pipeline/pipeline_output/pca_dataframe.pickle'.

--- Processing gRNA dictionary ---
Loading existing gRNA dictionary file '/project/GCRB/Hon_lab/s223695/Data_project/Perturb_seq_edist_pipeline/pipeline_output/gRNA_dictionary.pickle'.
gRNA dictionary loaded successfully. Found 11634 types of gRNAs.

--- Processing finished ---
Processing 2227 target regions...
Skipping target 'CGGBP1:P1': Needs at least 2 gRNAs, found 1.
Skipping target 'SMARCC1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'SMARCC2:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'CD29': Needs at least 2 gRNAs, found 1.
Skipping target 'GTF2H2:ENST00000274400.5,ENST00000330280.7': Needs at least 2 gRNAs, found 1.
Skipping target 'PSMB1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'SRCAP:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'CBFA2T3:P1': Needs at least 2 gRNAs, found 1.
Skipping target 'IGHMBP2:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'MSLN:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'NGFRAP1': Needs at least 2 gRNAs, found 1.
Skipping target 'PHB2:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'CXXC1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'TSHZ2:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'NCL:P1': Needs at least 2 gRNAs, found 1.
Skipping target 'GTF2F2:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'WDHD1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'CRTC3:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'ZNF20:P1': Needs at least 2 gRNAs, found 1.
Skipping target 'NCOA3:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'RELB:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'E2F3:P2': Needs at least 2 gRNAs, found 1.
Skipping target 'ARID1B:P1': Needs at least 2 gRNAs, found 1.
Skipping target 'ZFYVE20:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'E4F1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'MTA1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'MARS:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'ZNF592:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'ZNF207:P1': Needs at least 2 gRNAs, found 1.
Skipping target 'ADNP:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'HIRA:P2': Needs at least 2 gRNAs, found 1.
Skipping target 'GMEB1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'POU5F1:P1': Needs at least 2 gRNAs, found 1.
Skipping target 'DAXX:P1': Needs at least 2 gRNAs, found 1.
Skipping target 'CBFB:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'DMAP1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'PPP1CB:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'TAF13:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'ERG:P2': Needs at least 2 gRNAs, found 1.
Skipping target 'ZNF709:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'SON:P1': Needs at least 2 gRNAs, found 1.
Skipping target 'TFRC': Needs at least 2 gRNAs, found 1.
Skipping target 'CBFA2T2:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'CD55': Needs at least 2 gRNAs, found 1.
Skipping target 'WHSC1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'XRCC6:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'NFKB1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'ZNF704:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'ZNF142:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'ZNF444:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'PUF60:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'CREM:ENST00000395895.2': Needs at least 2 gRNAs, found 1.
Skipping target 'B2M': Needs at least 2 gRNAs, found 1.
Skipping target 'EBF4:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'MALAT1': Needs at least 2 gRNAs, found 1.
Skipping target 'ZNF395:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'DNAJC21:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'GLI2:ENST00000452319.1': Needs at least 2 gRNAs, found 1.
Skipping target 'KLF16:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'MYRF:P1': Needs at least 2 gRNAs, found 1.
Skipping target 'HDGF:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'SOX18:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'TERF2:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'PURG:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'OR9Q1': Needs at least 2 gRNAs, found 1.
Skipping target 'CTNNB1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'PFDN5:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'SACM1L:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'SMARCA5:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'DNMT1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'CDK1:P1P2': Needs at least 2 gRNAs, found 1.
Skipping target 'ZNF700:P1P2': Needs at least 2 gRNAs, found 1.

All target regions processed.
Starting Step 2: Disco Tests and Hypergeometric Outlier Calculation...

Finished processing all targets.
Aggregating results and saving to CSV...
Successfully saved outlier p-values to '/project/GCRB/Hon_lab/s223695/Data_project/Perturb_seq_edist_pipeline/pipeline_output/targeting_outlier_table.csv'
k-means analysis of non-targeting
[0 1 2] [462   1  95]
largest group:  0
largest group ratio:  0.828
[Step2] calculate energy distance between targets and non-targeting
--- Processing PCA data ---
Loading existing PCA file '/project/GCRB/Hon_lab/s223695/Data_project/Perturb_seq_edist_pipeline/pipeline_output/pca_dataframe.pickle'.

--- Processing gRNA dictionary ---
Loading existing gRNA dictionary file '/project/GCRB/Hon_lab/s223695/Data_project/Perturb_seq_edist_pipeline/pipeline_output/gRNA_dictionary.pickle'.
gRNA dictionary loaded successfully. Found 11634 types of gRNAs.

--- Processing finished ---
Total: 2155

Saving intermediate results after processing 10 regions...
Intermediate results saved.


Saving intermediate results after processing 20 regions...
Intermediate results saved.


Saving intermediate results after processing 30 regions...
Intermediate results saved.


Saving intermediate results after processing 40 regions...
Intermediate results saved.


Saving intermediate results after processing 50 regions...
Intermediate results saved.


Saving intermediate results after processing 60 regions...
Intermediate results saved.


Saving intermediate results after processing 70 regions...
Intermediate results saved.


Saving intermediate results after processing 80 regions...
Intermediate results saved.


Saving intermediate results after processing 90 regions...
Intermediate results saved.


Saving intermediate results after processing 100 regions...
Intermediate results saved.


Saving intermediate results after processing 110 regions...
Intermediate results saved.


Saving intermediate results after processing 120 regions...
Intermediate results saved.


Saving intermediate results after processing 130 regions...
Intermediate results saved.


Saving intermediate results after processing 140 regions...
Intermediate results saved.


Saving intermediate results after processing 150 regions...
Intermediate results saved.


Saving intermediate results after processing 160 regions...
Intermediate results saved.


Saving intermediate results after processing 170 regions...
Intermediate results saved.


Saving intermediate results after processing 180 regions...
Intermediate results saved.


Saving intermediate results after processing 190 regions...
Intermediate results saved.


Saving intermediate results after processing 200 regions...
Intermediate results saved.

Warning: No cells found for target region CGGBP1:P1. Skipping.

Saving intermediate results after processing 220 regions...
Intermediate results saved.


Saving intermediate results after processing 230 regions...
Intermediate results saved.


Saving intermediate results after processing 240 regions...
Intermediate results saved.


Saving intermediate results after processing 250 regions...
Intermediate results saved.


Saving intermediate results after processing 260 regions...
Intermediate results saved.


Saving intermediate results after processing 270 regions...
Intermediate results saved.


Saving intermediate results after processing 280 regions...
Intermediate results saved.


Saving intermediate results after processing 290 regions...
Intermediate results saved.


Saving intermediate results after processing 300 regions...
Intermediate results saved.


Saving intermediate results after processing 310 regions...
Intermediate results saved.


Saving intermediate results after processing 320 regions...
Intermediate results saved.


Saving intermediate results after processing 330 regions...
Intermediate results saved.


Saving intermediate results after processing 340 regions...
Intermediate results saved.


Saving intermediate results after processing 350 regions...
Intermediate results saved.


Saving intermediate results after processing 360 regions...
Intermediate results saved.


Saving intermediate results after processing 370 regions...
Intermediate results saved.


Saving intermediate results after processing 380 regions...
Intermediate results saved.


Saving intermediate results after processing 390 regions...
Intermediate results saved.


Saving intermediate results after processing 400 regions...
Intermediate results saved.


Saving intermediate results after processing 410 regions...
Intermediate results saved.


Saving intermediate results after processing 420 regions...
Intermediate results saved.


Saving intermediate results after processing 430 regions...
Intermediate results saved.


Saving intermediate results after processing 440 regions...
Intermediate results saved.


Saving intermediate results after processing 450 regions...
Intermediate results saved.


Saving intermediate results after processing 460 regions...
Intermediate results saved.


Saving intermediate results after processing 470 regions...
Intermediate results saved.


Saving intermediate results after processing 480 regions...
Intermediate results saved.

